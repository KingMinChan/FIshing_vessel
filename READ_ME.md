# AI 객체탐지 기술을 활용한 어선 선종 식별 기술 개발
2024 DATA·AI 분석 경진 대회의 해결 문제인 AI 객체탐지 기술을 이용한 어선 선종 식별 프로그램 구현입니다.
___
## 개요
항공 촬영된 어선의 선종 및 상태를 식별하고 분류함을 목표로 합니다. 국내 어선과 중국 어선의 종류와 운영 상태를 자동으로 식별하여 불법 조업 감시에 과다하게 필요한 노력을 줄이는 데 도움이 됩니다.
___
## 문제 배경
중국 어선의 불법 조업은 국내 어민들의 생존권을 위협하는 큰 문제입니다. 이러한 문제를 해결하기 위해 불법 조업 행위를 감지하는 것이 중요합니다. 현재에는 이러한 활동을 수작업으로 검증하고 있으며, 이는 많은 시간과 노력이 요구됩니다.

이 프로젝트의 목표는 항공에서 촬영한 이미지를 활용하여 어선의 종류와 운영 상태를 딥러닝을 통해 자동으로 분류하는 것입니다. 구체적으로 시스템은 다음을 달성해야 합니다.

* 1.선종 자동 분류
* 2.운영 상태 자동 인식
* 3.위치 좌표 자동 추출


##  1.선종 자동 분류
### 모델 아키텍처
---
어선 상태 분류를 위해 ResNet50 모델이 선택되었으며, 이는 이미지 처리 작업에서 높은 성능을 보이는 모델입니다. ResNet50은 깊은 신경망 구조에서 발생할 수 있는 기울기 소실 문제를 해결하기 위해 스킵 연결(skip connection)을 사용하는 잔차 블록(residual block)으로 구성되어 있습니다. 이러한 아키텍처는 여러 개의 합성곱 레이어와 최대 풀링 레이어로 구성되어 있으며, 어선 상태를 구분하는 데 필요한 고수준의 특징을 학습할 수 있습니다.

**입력** : 입력은 사전 처리된 어선 이미지입니다.(필요에 따라서 대비값 조정)

**합성곱 레이어** : 이 레이어들은 이미지에서 어선의 외형, 구조와 같은 특징을 추출합니다.

**완전 연결 레이어** : 추출된 특징들은 완전 연결 레이어를 통해 어선 종류를 분류합니다.

**출력** : 최종 레이어는 어선을 10가지 종류 (타망, 유망, 연승, 안강망 등) 중 하나로 분류합니다.


### 학습
---
**데이터셋 준비** : 이미지는 각 어선 종류와 상태로 레이블이 지정됩니다. 모델의 견고성을 높이기 위해 이미지 뒤집기, 자르기, 밝기, 대비 조정 등의 데이터 증강 기법이 적용됩니다.

**하이퍼파라미터** : 교차 엔트로피 손실 함수가 사용하며 총 550 에포크(300 -> 100 -> 100 -> 50 순으로 학습 반복함.)동안 학습합니다.

### 기대 결과
---
**상태 인식** : 어선의 종류를 자동으로 감지하여 불법 조업 활동 감시에 기여할 수 있습니다.

##  2.운영 상태 자동 인식


### 모델 아키텍처
---
어선 상태 분류를 위해 **VGG 모델**이 선택되었으며, 이는 이미지 처리 작업에서 높은 성능을 보이는 모델입니다. 아키텍처는 여러 개의 합성곱 레이어와 최대 풀링 레이어로 구성되어 있으며, 어선 상태를 구분하는 데 필요한 고수준의 특징을 학습할 수 있습니다.

**입력** : 입력은 사전 처리된 어선 이미지입니다.

**합성곱 레이어** : 이 레이어들은 이미지에서 어선의 모양과 운영 상황과 같은 특징을 추출합니다.

**완전 연결 레이어** : 추출된 특징들은 완전 연결 레이어를 통해 어선 상태를 분류합니다.

**출력** : 최종 레이어는 어선을 세 가지 상태 (이동 중, 표류 중, 조업 중) 중 하나로 분류합니다.


### 학습
---
**데이터셋 준비** : 이미지는 각 어선 종류와 상태로 레이블이 지정됩니다. 모델의 견고성을 높이기 위해 이미지 뒤집기, 자르기, 밝기 조정 등의 데이터 증강 기법이 적용됩니다.

**하이퍼파라미터** : 학습에는 학습률 0.001, 배치 크기 32, 교차 엔트로피 손실 함수가 사용됩니다. 50 에포크 동안 학습하며, 과적합을 방지하기 위해 검증 분할을 사용합니다.

### 평가
---
모델 성능은 각 클래스의 정밀도와 재현율을 고려한 매크로 F1 스코어를 사용해 평가됩니다. 이 지표는 클래스 분포가 불균형한 경우에도 균형 잡힌 평가를 보장합니다.

**어선 상태 분류** (3 클래스): 운영 상태를 정확히 분류하는 능력을 매크로 F1 스코어로 평가합니다.


### 기대 결과
---
**상태 인식** : 어선의 상태도 자동으로 감지하여 불법 조업 활동 감시에 기여할 수 있습니다.

## 3.위치 좌표 자동 추출
### 모델 아키텍처
---
위치 정보 추출을 위해 **easyocr(Optical Character Recognition)** 모델을 사용합니다. Tesseract와 같은 기존의 OCR 모델을 사용하거나, 딥러닝 기반의 **CRNN(Convolutional Recurrent Neural Network)** 모델을 활용하여 이미지에서 텍스트를 인식합니다. **CRNN** 모델은 합성곱 신경망을 통해 특징을 추출하고, 순환 신경망을

 통해 문맥 정보를 반영하여 텍스트를 인식합니다.

**입력** : 입력은 위치 정보를 포함한 사전 처리된 어선 이미지입니다.

**합성곱 레이어** : 이미지에서 텍스트 특징을 추출하기 위해 합성곱 레이어가 사용됩니다.

**순환 레이어** : 추출된 특징들은 순환 레이어를 통해 문맥적 정보를 학습하고, 텍스트 시퀀스를 인식합니다.

**출력** : 최종 레이어는 위치 좌표 텍스트를 예측하여 추출합니다.

### 학습
---
**데이터셋 준비** : 위치 정보를 포함한 텍스트가 잘 인식되도록 이미지의 크기를 조정하고, 텍스트 영역을 명확히 하기 위한 대비 조정 및 필터링을 수행합니다. 모델의 견고성을 높이기 위해 회전, 밝기 변화 등의 데이터 증강 기법이 적용됩니다.

**하이퍼파라미터** : 학습률 0.001, 배치 크기 16으로 설정하고, **문자열 손실 함수(CTC Loss)**를 사용하여 모델을 학습합니다. 100 에포크 동안 학습하며, 검증 데이터셋을 사용하여 성능을 평가합니다.

### 평가
---
모델 성능은 문자열 정확 매칭 정확도(String Exact Matching Accuracy)를 사용해 평가됩니다. 이 지표는 모델이 예측한 문자열이 실제 정답 문자열과 정확히 일치하는지를 평가합니다.

**위치 정보 추출 정확도** : 추출된 위치 좌표 문자열이 실제 좌표와 정확히 일치하는지 여부를 기준으로 평가하였습니다.

### 기대 결과
---
**위치 정보 자동 추출** : 이미지에서 위치 좌표를 자동으로 추출함으로써, 항공 정찰팀의 수작업을 줄이고 효율적인 불법 조업 감시 체계를 구축할 수 있습니다.

